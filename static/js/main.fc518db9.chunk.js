(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,s){},8:function(e,t,s){e.exports=s(9)},9:function(e,t,s){"use strict";s.r(t);var r=s(1),n=s(2),o=s(4),a=s(3),i=s(5),c=s(0),l=s.n(c),u=s(7),h=s.n(u),v=(s(15),["white","red","green","blue","cyan","magenta","yellow"]);function f(e,t){return t<0||t>=e.length}function k(e){return l.a.createElement("button",{className:"square",style:{background:v[e.value]}})}var p=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(a.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(n.a)(t,[{key:"renderRow",value:function(e,t){return l.a.createElement("div",{className:"board-row",key:t},e.map(function(e,t){return l.a.createElement(k,{value:e,key:t})}))}},{key:"render",value:function(){var e=this;return l.a.createElement("div",null,this.props.rows.map(function(t,s){return e.renderRow(t,s)}))}}]),t}(l.a.Component),m=function(e){function t(e){var s;return Object(r.a)(this,t),(s=Object(o.a)(this,Object(a.a)(t).call(this,e))).state={scoreCount:0},s}return Object(i.a)(t,e),Object(n.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.lerp||(this.lerp=setInterval(function(){return t.lerpScore()},1e3/60))}},{key:"lerpScore",value:function(){var e=this.state.scoreCount;(e+=(this.props.score-e)/3+1)>=this.props.score&&(e=this.props.score,clearInterval(this.lerp),this.lerp=null),this.setState({scoreCount:e})}},{key:"render",value:function(){return l.a.createElement("div",{className:"score"},("000000000"+this.state.scoreCount.toFixed(0)).slice(-"000000000".length))}}]),t}(l.a.Component),y=function(e){function t(e){var s;return Object(r.a)(this,t),(s=Object(o.a)(this,Object(a.a)(t).call(this,e))).state={score:0,speed:100,rows:[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]],tetris:{blocks:[],value:0}},s}return Object(i.a)(t,e),Object(n.a)(t,[{key:"clearRow",value:function(e){for(var t=0;t<e.length;++t)e[t]=0}},{key:"clearBoard",value:function(){for(var e=this.state.rows,t=0;t<e.length;++t)this.clearRow(e[t]);var s=this.state.tetris;s.blocks=[],this.setState({rows:e,tetris:s})}},{key:"onLoop",value:function(){var e=this;this.gameLoop=setTimeout(function(){return e.tick()},this.state.speed)}},{key:"endLoop",value:function(){this.gameLoop&&(clearTimeout(this.gameLoop),this.gameLoop=null)}},{key:"overwriteLoop",value:function(){this.endLoop(),this.tick()}},{key:"componentDidMount",value:function(){this.clearBoard(),this.onLoop()}},{key:"componentWillUnmount",value:function(){this.endLoop()}},{key:"onNewGame",value:function(){this.endLoop(),this.clearBoard(),this.onLoop()}},{key:"applyTetris",value:function(e,t,s){for(var r=0;r<t.length;++r)e[t[r][0]][t[r][1]]=s}},{key:"isEmpty",value:function(e,t,s){return 0===e[t][s]}},{key:"isRepeat",value:function(e,t,s,r){for(var n=0;n<e.length;++n)if(t!==n&&e[t][0]+s===e[n][0]&&e[t][1]+r===e[n][1])return!0;return!1}},{key:"canMove",value:function(e,t,s,r){for(var n=0;n<t.length;++n){if(f(e,t[n][0]+s))return 0;if(f(e[t[n][0]+s],t[n][1]+r))return 2;if(!this.isRepeat(t,n,s,r)&&!this.isEmpty(e,t[n][0]+s,t[n][1]+r))return 0===r?-1:2}return 1}},{key:"onMoveTetris",value:function(e,t){var s=this.state.rows.slice(),r=Object.assign({},this.state.tetris);switch(this.canMove(s,r.blocks,e,t)){case 2:t=0;case 1:return this.applyTetris(s,r.blocks,0),this.shiftBlocks(r.blocks,e,t),this.applyTetris(s,r.blocks,r.value),this.setState({rows:s,tetris:r}),!0;default:return!1}}},{key:"moveTetris",value:function(e,t){this.onMoveTetris(e,t)||(this.checkBoard(),this.spawnTetris())}},{key:"moveTetrisRecursive",value:function(e,t){for(;this.onMoveTetris(e,t););}},{key:"checkRow",value:function(e){for(var t=0;t<e.length;++t)if(0===e[t])return!1;return!0}},{key:"shiftRows",value:function(e,t){for(var s=t;s>=0;--s)e[s]=s>0?e[s-1].slice():new Array(10).fill(0)}},{key:"checkBoard",value:function(){for(var e=this.state.rows.slice(),t=this.state.score,s=e.length-1;s>=0;--s)this.checkRow(e[s])&&(t+=1e3,this.shiftRows(e,s),++s);this.setState({score:t,rows:e})}},{key:"getRotatedTetrisLeft",value:function(e,t,s,r,n){return{x:r+e-t,y:s+t-e}}},{key:"shiftBlocks",value:function(e,t,s){for(var r=0;r<e.length;++r)e[r][0]+=t,e[r][1]+=s}},{key:"unclipTetris",value:function(e,t){for(var s=0;s<t.length;++s){for(;t[s][0]<0;)this.shiftBlocks(t,1,0);for(;t[s][0]>=e.length;)this.shiftBlocks(t,-1,0);for(;t[s][1]<0;)this.shiftBlocks(t,0,1);for(;t[s][1]>=e[0].length;)this.shiftBlocks(t,0,-1);for(;!this.isEmpty(e,t[s][0],t[s][1]);)this.shiftBlocks(t,-1,0)}}},{key:"rotateTetris",value:function(){var e=this.state.rows.slice(),t=Object.assign({},this.state.tetris);this.applyTetris(e,t.blocks,0);for(var s=0;s<t.blocks.length;++s){var r=this.getRotatedTetrisLeft(t.blocks[t.blocks.length/2][0],t.blocks[t.blocks.length/2][1],t.blocks[s][0],t.blocks[s][1]);t.blocks[s][0]=r.x,t.blocks[s][1]=r.y}this.unclipTetris(e,t.blocks),this.applyTetris(e,t.blocks,t.value),this.setState({rows:e,tetris:t})}},{key:"spawnTetris",value:function(){var e,t,s={blocks:[[0,3],[0,4],[0,5],[0,6]],value:(e=1,t=v.length,Math.floor(Math.random()*(t-e))+e)},r=this.state.rows.slice();this.canMove(r,s.blocks,0,0)>0?(this.applyTetris(r,s.blocks,s.value),this.setState({rows:r,tetris:s})):this.endLoop()}},{key:"tick",value:function(){0===this.state.tetris.blocks.length?this.spawnTetris():this.moveTetris(1,0),this.onLoop()}},{key:"handleKeyPress",value:function(e){if(this.gameLoop)switch(e.key){case"ArrowLeft":this.moveTetris(0,-1);break;case"ArrowUp":this.rotateTetris(this.state.tetris);break;case"ArrowRight":this.moveTetris(0,1);break;case"ArrowDown":this.moveTetris(1,0);break;case" ":this.moveTetrisRecursive(1,0)}}},{key:"onSpeedChange",value:function(e){this.setState({speed:e.target.value})}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"game"},l.a.createElement("div",{className:"game-board",onKeyDown:function(t){e.handleKeyPress(t)}},l.a.createElement(m,{score:this.state.score}),l.a.createElement(p,{rows:this.state.rows}),l.a.createElement("br",null),l.a.createElement("button",{onClick:function(){return e.onNewGame()}},"New Game"),l.a.createElement("br",null),l.a.createElement("br",null),"Speed:\xa0",l.a.createElement("input",{type:"range",style:{direction:"rtl"},value:this.state.speed,min:"100",max:"500",onChange:function(t){e.onSpeedChange(t)}})),l.a.createElement("div",{className:"game-info"},l.a.createElement("div",null),l.a.createElement("ol",null)))}}]),t}(l.a.Component);h.a.render(l.a.createElement(y,null),document.getElementById("root"))}},[[8,1,2]]]);
//# sourceMappingURL=main.fc518db9.chunk.js.map