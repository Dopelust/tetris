(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,s){},8:function(e,t,s){e.exports=s(9)},9:function(e,t,s){"use strict";s.r(t);var o=s(1),r=s(2),i=s(4),n=s(3),a=s(5),l=s(0),c=s.n(l),u=s(7),h=s.n(u),v=(s(15),["white","yellow","cyan","orange","blue","magenta","green","red"]),p=[{blocks:[],pivot:[],value:0},{blocks:[[0,4],[0,5],[1,4],[1,5]],pivot:[.5,-.5],value:1},{blocks:[[0,3],[0,4],[0,5],[0,6]],pivot:[.5,.5],value:2},{blocks:[[0,4],[1,4],[2,4],[2,5]],pivot:[0,0],value:3},{blocks:[[0,5],[1,5],[2,5],[2,4]],pivot:[0,0],value:4},{blocks:[[0,4],[1,4],[2,4],[1,5]],pivot:[0,0],value:5},{blocks:[[0,4],[1,4],[1,5],[2,5]],pivot:[0,0],value:6},{blocks:[[0,5],[1,5],[1,4],[2,4]],pivot:[0,0],value:7}];function f(e,t){return t<0||t>=e.length}function k(e){return c.a.createElement("button",{className:"square",style:{background:v[e.value],borderTop:e.t?" solid #eee":"0px solid",borderBottom:e.b?" solid":"0px solid",borderLeft:e.l?" solid #eee":"0px solid",borderRight:e.r?" solid":"0px solid"}})}var b=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(n.a)(t).apply(this,arguments))}return Object(a.a)(t,e),Object(r.a)(t,[{key:"renderRow",value:function(e,t,s){return c.a.createElement("div",{className:"board-row",key:s},t.map(function(o,r){return c.a.createElement(k,{l:0===r||t[r]>0&&0===t[r-1],r:9===r||t[r]>0&&0===t[r+1],t:0===s||t[r]>0&&0===e[s-1][r],b:15===s||t[r]>0&&0===e[s+1][r],value:o,key:r})}))}},{key:"render",value:function(){var e=this;return c.a.createElement("div",null,this.props.rows.map(function(t,s){return e.renderRow(e.props.rows,t,s)}))}}]),t}(c.a.Component),m=function(e){function t(e){var s;return Object(o.a)(this,t),(s=Object(i.a)(this,Object(n.a)(t).call(this,e))).state={scoreCount:0},s}return Object(a.a)(t,e),Object(r.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;this.lerp||(this.lerp=setInterval(function(){return t.lerpScore()},1e3/60))}},{key:"lerpScore",value:function(){var e=this.state.scoreCount;(e+=(this.props.score-e)/3+1)>=this.props.score&&(e=this.props.score,clearInterval(this.lerp),this.lerp=null),this.setState({scoreCount:e})}},{key:"render",value:function(){return c.a.createElement("div",{className:"score"},("000000000"+this.state.scoreCount.toFixed(0)).slice(-"000000000".length))}}]),t}(c.a.Component),d=function(e){function t(e){var s;return Object(o.a)(this,t),(s=Object(i.a)(this,Object(n.a)(t).call(this,e))).state={score:0,speed:300,rows:[[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0]],tetris:{blocks:[],value:0}},s}return Object(a.a)(t,e),Object(r.a)(t,[{key:"clearRow",value:function(e){for(var t=0;t<e.length;++t)e[t]=0}},{key:"clearBoard",value:function(){for(var e=this.state.rows,t=0;t<e.length;++t)this.clearRow(e[t]);var s=this.state.tetris;s.blocks=[],this.setState({rows:e,tetris:s,score:0})}},{key:"onLoop",value:function(){var e=this;this.gameLoop=setTimeout(function(){return e.tick()},this.state.speed)}},{key:"endLoop",value:function(){this.gameLoop&&(clearTimeout(this.gameLoop),this.gameLoop=null)}},{key:"overwriteLoop",value:function(){this.endLoop(),this.tick()}},{key:"componentDidMount",value:function(){this.clearBoard(),this.onLoop()}},{key:"componentWillUnmount",value:function(){this.endLoop()}},{key:"onNewGame",value:function(){this.endLoop(),this.clearBoard(),this.onLoop()}},{key:"applyTetris",value:function(e,t,s){for(var o=0;o<t.length;++o)f(e,t[o][0])||f(e[t[o][0]],t[o][1])||(e[t[o][0]][t[o][1]]=s)}},{key:"isEmpty",value:function(e,t,s){return 0===e[t][s]}},{key:"isRepeat",value:function(e,t,s,o){for(var r=0;r<e.length;++r)if(t!==r&&e[t][0]+s===e[r][0]&&e[t][1]+o===e[r][1])return!0;return!1}},{key:"canMove",value:function(e,t,s,o){for(var r=0;r<t.length;++r){if(f(e,t[r][0]+s))return 0;if(f(e[t[r][0]+s],t[r][1]+o))return 2;if(!this.isRepeat(t,r,s,o)&&!this.isEmpty(e,t[r][0]+s,t[r][1]+o))return 0===o?-1:2}return 1}},{key:"onMoveTetris",value:function(e,t){var s=this.state.rows.slice(),o=Object.assign({},this.state.tetris);switch(this.canMove(s,o.blocks,e,t)){case 2:t=0;case 1:return this.applyTetris(s,o.blocks,0),this.shiftBlocks(o.blocks,e,t),this.applyTetris(s,o.blocks,o.value),this.setState({rows:s,tetris:o}),!0;default:return!1}}},{key:"moveTetris",value:function(e,t){this.onMoveTetris(e,t)||(this.checkBoard(),this.spawnTetris())}},{key:"moveTetrisRecursive",value:function(e,t){for(;this.onMoveTetris(e,t););}},{key:"checkRow",value:function(e){for(var t=0;t<e.length;++t)if(0===e[t])return!1;return!0}},{key:"shiftRows",value:function(e,t){for(var s=t;s>=0;--s)e[s]=s>0?e[s-1].slice():new Array(10).fill(0)}},{key:"checkBoard",value:function(){for(var e=this.state.rows.slice(),t=this.state.score,s=e.length-1;s>=0;--s)this.checkRow(e[s])&&(t+=1e3,this.shiftRows(e,s),++s);this.setState({score:t,rows:e})}},{key:"getRotatedTetrisLeft",value:function(e,t,s,o,r){return{x:-1*(o-t)+e,y:1*(s-e)+t}}},{key:"getRotatedTetrisRight",value:function(e,t,s,o,r){return{x:1*(o-t)+e,y:-1*(s-e)+t}}},{key:"shiftBlocks",value:function(e,t,s){for(var o=0;o<e.length;++o)e[o][0]+=t,e[o][1]+=s}},{key:"unclipTetris",value:function(e,t){for(var s=0;s<t.length;++s){for(;t[s][0]<0;)this.shiftBlocks(t,1,0);for(;t[s][0]>=e.length;)this.shiftBlocks(t,-1,0);for(;t[s][1]<0;)this.shiftBlocks(t,0,1);for(;t[s][1]>=e[0].length;)this.shiftBlocks(t,0,-1);for(;!this.isEmpty(e,t[s][0],t[s][1]);)this.shiftBlocks(t,-1,0)}}},{key:"rotateTetris",value:function(){var e=this.state.rows.slice(),t=Object.assign({},this.state.tetris);this.applyTetris(e,t.blocks,0);for(var s=t.blocks[t.blocks.length/2-1][0]+t.pivot[0],o=t.blocks[t.blocks.length/2-1][1]+t.pivot[1],r=0;r<t.blocks.length;++r){var i=this.getRotatedTetrisRight(s,o,t.blocks[r][0],t.blocks[r][1]);t.blocks[r][0]=i.x,t.blocks[r][1]=i.y}var n=this.getRotatedTetrisRight(0,0,t.pivot[0],t.pivot[1]);t.pivot[0]=n.x,t.pivot[1]=n.y,this.unclipTetris(e,t.blocks),this.applyTetris(e,t.blocks,t.value),this.setState({rows:e,tetris:t})}},{key:"spawnTetris",value:function(){var e,t,s=JSON.parse(JSON.stringify(p))[(e=1,t=p.length,Math.floor(Math.random()*(t-e))+e)],o=this.state.rows.slice();this.canMove(o,s.blocks,0,0)>0?(this.applyTetris(o,s.blocks,s.value),this.setState({rows:o,tetris:s})):this.endLoop()}},{key:"tick",value:function(){0===this.state.tetris.blocks.length?this.spawnTetris():this.moveTetris(1,0),this.onLoop()}},{key:"handleKeyPress",value:function(e){switch(e.key){case"ArrowLeft":this.moveTetris(0,-1);break;case"ArrowUp":this.rotateTetris(this.state.tetris);break;case"ArrowRight":this.moveTetris(0,1);break;case"ArrowDown":this.moveTetris(1,0);break;case" ":this.moveTetrisRecursive(1,0);break;case"r":this.onNewGame();break;case"s":this.gameLoop?this.endLoop():this.onLoop()}}},{key:"onSpeedChange",value:function(e){this.setState({speed:e.target.value})}},{key:"render",value:function(){var e=this;return c.a.createElement("div",{className:"game"},c.a.createElement("div",{className:"game-board",onKeyDown:function(t){e.handleKeyPress(t)}},c.a.createElement(m,{score:this.state.score}),c.a.createElement(b,{rows:this.state.rows}),c.a.createElement("br",null),c.a.createElement("button",{className:"keycapButton",onClick:function(){return e.onNewGame()}},"R"),"  to Reset",c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("br",null),"Speed:\xa0",c.a.createElement("input",{type:"range",style:{direction:"rtl"},value:this.state.speed,min:"100",max:"500",onChange:function(t){e.onSpeedChange(t)}})),c.a.createElement("div",{className:"game-info"},c.a.createElement("div",null),c.a.createElement("ol",null)))}}]),t}(c.a.Component);h.a.render(c.a.createElement(d,null),document.getElementById("root"))}},[[8,1,2]]]);
//# sourceMappingURL=main.faaad1d5.chunk.js.map